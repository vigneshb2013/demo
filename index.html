<!doctype html>
<html>
<head><meta charset="utf-8"><title>Show local IP (local only)</title></head>
<body>
  <h2>Your local IPs (if available):</h2>
  <pre id="out">Detecting…</pre>

<script>
/* Runs in the visitor's browser; they must open this file locally.
   Modern browsers may not reveal private IPs due to privacy protections. */
(async function() {
  const out = document.getElementById('out');
  if (!window.RTCPeerConnection) {
    out.textContent = 'RTCPeerConnection not available in this browser.';
    return;
  }

  const ips = new Set();
  function addIp(ip){ ips.add(ip); out.textContent = Array.from(ips).join('\n'); }

  // Create peer connection and gather ICE candidates
  const pc = new RTCPeerConnection({iceServers:[]});
  pc.createDataChannel(''); // create a bogus data channel

  pc.onicecandidate = (e) => {
    if(!e.candidate) return;
    const cand = e.candidate.candidate;
    // candidate string contains IPs — extract them
    const parts = cand.match(/([0-9]{1,3}(\.[0-9]{1,3}){3})|([0-9a-f:]+)/g);
    if(parts) parts.forEach(p => addIp(p));
  };

  try {
    const offer = await pc.createOffer();
    await pc.setLocalDescription(offer);
    // give browser a bit of time to gather candidates
    setTimeout(()=> {
      // close after some time
      try{ pc.close(); }catch(e){}
      if(ips.size===0) out.textContent = 'No local IPs detected (browser prevented access).';
    }, 2000);
  } catch (err) {
    out.textContent = 'Error: ' + err;
  }
})();
</script>
</body>
</html>
