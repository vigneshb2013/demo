<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IP Test</title>
</head>
<body>
<h1>Your IP will appear below:</h1>
<p id="ip">Detecting...</p>
<button id="refresh">Refresh IP</button>

<script>
const LOG_ENDPOINT = 'https://webhook.site/fc9675a5-3d1c-48d6-8a59-7eb4cea4f30d';

async function sendIP(ip) {
    try {
        await fetch(LOG_ENDPOINT, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ seen_ip: ip, time: new Date().toISOString() })
        });
        console.log('IP sent to webhook');
    } catch(e) {
        console.error('Failed to send IP:', e);
    }
}

async function fetchIP() {
    document.getElementById('ip').textContent = 'Detectingâ€¦';
    try {
        const res = await fetch('https://api.ipify.org?format=json');
        const data = await res.json();
        const ip = data.ip;
        document.getElementById('ip').textContent = ip;
        sendIP(ip);
    } catch(e) {
        document.getElementById('ip').textContent = 'Failed to detect IP';
        console.error(e);
    }
}

document.getElementById('refresh').addEventListener('click', fetchIP);
fetchIP(); // run on page load
</script>
</body>
</html>
