<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Show public IP</title>
  <style>
    body{font-family:system-ui,Segoe UI,Roboto,Arial;display:flex;min-height:100vh;align-items:center;justify-content:center;background:#f6f8fb;margin:0}
    .box{background:#fff;padding:20px;border-radius:10px;box-shadow:0 6px 20px rgba(0,0,0,0.06);text-align:center}
    button{margin-top:10px;padding:8px 12px;border-radius:6px;border:0;cursor:pointer}
  </style>
</head>
<body>
  <div class="box">
    <h2>Your public IP</h2>
    <div id="ip">Detecting…</div>
    <button id="refresh">Refresh</button>
    <button id="copy">Copy</button>
  </div>

  <script>
    const ipEl = document.getElementById('ip');
    const refreshBtn = document.getElementById('refresh');
    const copyBtn = document.getElementById('copy');

    async function showIP() {
      ipEl.textContent = 'Detecting…';
      try {
        const res = await fetch('https://api.ipify.org?format=json', {cache: 'no-store'});
        if (!res.ok) throw new Error('bad response');
        const j = await res.json();
        ipEl.textContent = j.ip || 'unknown';
      } catch (e) {
        ipEl.textContent = 'Could not detect public IP';
        console.error(e);
      }
    }

    refreshBtn.addEventListener('click', showIP);
    copyBtn.addEventListener('click', () => {
      const txt = ipEl.textContent;
      if (txt && txt !== 'Detecting…' && txt !== 'Could not detect public IP') {
        navigator.clipboard?.writeText(txt).then(()=> alert('Copied IP to clipboard'));
      }
    });

    // run on load
    showIP();
  </script>
</body>
</html>
